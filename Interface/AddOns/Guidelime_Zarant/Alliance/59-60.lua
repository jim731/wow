
Guidelime.registerGuide([[
[N59-59Winterspring/Un'Goro/Silithus part 1]
[NX59-60Winterspring/Un'Goro/Silithus part 2]
[GA Alliance]
[D Alliance Leveling Guide]
Take the tram to SW[OC]
Turn in [QT6186]
[G44.27,73.99Stormwind City]Do the Stormwind cloth turn ins:\\[QA7791-][O][QT7791-][O]Wool \\[QA7793-][O][QT7793-][O]Silk \\[QA7794-][O][QT7794-][O]Mageweave \\[QA7795-][O][QT7795-][O]Runecloth
Fly to [F Booty Bay]
Take the boat to ratchet [OC]
[V][O]Withdraw Tinkee's Letter from your bank --BANKFRAME_OPENED,BAG_UPDATE>>BankW_Letter59

Fly to [F Winterspring]
[A Hunter][O]Once you get to level 59, stable your current pet, head to northern winterspring and replace it by a level 59 Owl
[S]Set your HS to Everlook

Turn in [QT4808] \\Accept [QA4809]
Accept [QA969]
Accept [QA3783 Are We There, Yeti?]
Do [QC3783 Are We There, Yeti?]
Turn in [QT3783 Are We There, Yeti?]
Accept [QA977]
[QC4809-]Kill chillwind chimeras, don't go out of your way to finish it[O]
Do [QC5121]
Loot the Crudely-written Log from the High Chief\\Accept [QA5123]
Do [QC977]
Start the escort quest\\Accept [QA4901]
[QC4901-]Escort Ranshalla and click on the torches once she enters one of the caves
Head south to Frowstwhisper Gorge\\Do [QC969] \\The elite giants are immune to frost, not every class can solo this quest
[H]Hearth to Everlook - Do not skip this step
Turn in [QT977] \\Accept [QA5163]
[QC5163,1-]Use the Mechanical Yet on Legacki
Turn in [QT969]
[V][O]Withdraw the following: \\Rabine's Letter\\Silvery Claws\\Irontree Heart\\Remains of Trey Lightforge\\Shadow Lord Fel'dan's Head--BANKFRAME_OPENED,BAG_UPDATE>>BankW_Winterspring59
Turn in [QT5121] \\Turn in [QT5123] \\Accept [QA5128]

Head to Moonglade[OC]
Turn in [QT6762 Rabine Saturna] \\Accept [QA1124 Wasteland]
Finish the dialogue with Rabine\\Accept [QA5527 A Reliquary of Purity] \\Skip this step if the Dire Maul dialogue is not available--GOSSIP_SHOW>>SkipGossip
Unstuck to the Moonglade graveyard and spirit rez[OC]
[G48.13,67.34Moonglade]Get the [P Moonglade] FP
Head back to the fulborg tunnel\\Once the zone text changes to Felwood, unstuck back to the graveyard and spirit rez[OC]
[G40.84,66.78,40Felwood]Run south to the slime pond\\[G56.4,86.8,40]Death warp to southern Felwood
Turn in [QT5242]
Turn in [QT5385]
Turn in [QT5128]
Turn in [QT4084] \\Accept [QA4005]
Run south to Ashenvale unstuck and spirit rez at Astranaar[OC]

Fly to [F Tanaris]
Accept [QA4507]
[QC5163,2-]Use the Mechanical Yeti on Sprinkle
[G70.43,49.93Tanaris]Head to the pirate area\\Right click on Eridan's Supplies\\Use the book of Aquor to summon [QC4005]

Head back to Gadgetzan\\Fly to [F Un'Goro Crater]
Turn in [QT4005] \\Accept [QA3961]
Turn in [QT3961] \\Accept [QA3962]
[G43.67,9.38 Un'Goro Crater][QC5163,3-]Use the Mechanical Yeti on Quixxil
--[QC4513-][O]Kill slimes as you go along, use the sample jar on their corpses
[QC3962,1-]Equip the Silver Totem of Aquementas on your off-hand\\Use it on Blazerunner at the top of the volcano
[G50.28,49.98 Un'Goro Crater][QC3962,2-]Click on the chest at the back of the cave
Head south and enter the bug hole\\[L44.13,81.41 Un'Goro Crater]Use the *Gorishi Queen Lure* after clearing the circular room\\[QC4507-]Clear all 3 waves of mobs
[G88.40,23.81,60 Silithus]Head to Silithus

Turn in [QT1124] \\Accept [QA1125]

--Phase 4
[OC]Head to Cenarion Hold--PLAYER_XP_UPDATE,QUEST_LOG_UPDATE,OnStepActivation,OnStepCompletion>>XpTo60,Head to Cenarion Hold
Talk to the goblin at the 2nd floor of the inn\\[G51.8,38.6Silithus]Accept [QA8277 Deadly Desert Venom]
Click on the wanted poster\\[G51.3,38.2Silithus]Accept [QA8283 Wanted - Deathclasp, Terror of the Sands]
Turn in [QT8275][OC]
[G51.2,38.2Silithus]Accept [QA8280 Securing the Supply Lines]
[G49.6,37.3Silithus]Accept [QA8284 The Twilight Mystery]
[G49.2,34.2Silithus]Accept [QA8304 Dearest Natalia]
[G48.6,37.8Silithus]Accept [QA8318 Secret Communication]

Kill [QC8280,1-][O]Dredge Striker (x15)
Collect [QC8277,1-][O]Stonelash Scorpid Stinger (x8)\\
Collect [QC8277,2-][O]Sand Skitterer Fang (x8)
--

[G63.22,55.35 Silithus][QC5527-]Click on the small urn inside the lodge
Finish off [QC1125]
Turn in [QT1125] \\Accept [QA1126]
[G60.22,52.55 Silithus][QC1126-]Clear the 3 bugs that spawn at the base of the tower\\Click on the object at the top of the tower\\Kill the 2 ambushers that spawn after clicking it
Turn in [QT1126] \\Accept [QA6844]--Hive in the Tower

--Phase 4
[O]From this point forward, stop questing in silithus and skip straight to the part 2 of this guide once you have enough XP to ding from turn ins\\You need about 55k xp total, assuming you haven't skipped any quests--PLAYER_XP_UPDATE,QUEST_LOG_UPDATE,OnStepActivation,OnStepCompletion>>XpTo60,Stop questing in Silithus and skip straight to the part 2 of this guide once you have enough XP
--48540 if you don't have reliquary of purity (pre Dire Maul)
[G23.5,13.7Silithus]Collect [QC8284,1-]Twilight Tablet Fragment (x8)
Finish off the following quests:\\[QC8277] \\[QC8280]


[G49.7,37.3Silithus]Turn in [QT8284 The Twilight Mystery]\\
Accept [QA8285 The Deserter]
[G51.1,38.2Silithus]Turn in [QT8280 Securing the Supply Lines]\\
Accept [QA8281 Stepping Up Security]
[G51.7,38.5Silithus]Turn in [QT8277 Deadly Desert Venom]\\
Accept [QA8278 Noggle's Last Hope]

Collect [QC8278,1-][O]Stonelash Flayer Stinger (x3)\\
Collect [QC8278,2-][O]Stonelash Pincer Stinger (x3)\\
Collect [QC8278,3-][O]Rock Stalker Fang (x3)
Kill [QC8281,1-]Dredge Crusher (x20)
[G41.3,88.5Silithus][QC8304,2-]Speak with Rutgar
[G40.8,88.8Silithus][QC8304,1-]Speak with Frankal

[G45.0,92.2Silithus]Collect [QC8283,1-]Deathclasp's Pincer
[G67.2,69.7Silithus]Turn in [QT8285 The Deserter]\\
Accept [QA8279 The Twilight Lexicon]

Make sure to finish off all quests before heading back to Cenarion Hold\\ \\[G51.1,38.2Silithus]Turn in [QT8281 Stepping Up Security]
[G51.7,38.5Silithus]Turn in [QT8278 Noggle's Last Hope]\\Accept [QA8282 Noggle's Lost Satchel]
[G49.2,34.3Silithus]Turn in [QT8304 Dearest Natalia]
[G50.8,33.6Silithus]Turn in [QT8283 Wanted - Deathclasp, Terror of the Sands]

Kill twilight cultists as you quest\\Collect [QC8318,1-][O]Encrypted Twilight Text (x10)
Kill [QC8279,3-]Twilight Keeper Havunth\\He patrols the twilight camp next to Cenarion Hold
Kill [QC8279,1-]Twilight Keeper Mayna\\She patrols the twilight camp directly west of Cenarion Hold
Kill [QC8279,2-]Twilight Keeper Exeter\\He is at the back of the southwestern twilight camp
[G44.5,91.4Silithus]Collect [QC8282,1-]Noggle's Satchel
[G67.2,69.8Silithus]Turn in [QT8279 The Twilight Lexicon]\\
Accept [QA8287 A Terrible Purpose]\\
Accept [QA8323 True Believers]

Head to Cenarion Hold\\[G51.7,38.5Silithus]Turn in [QT8282 Noggle's Lost Satchel]
[G49.2,34.2Silithus]Turn in [QT8287 A Terrible Purpose]
[G48.7,37.5,50Silithus]Finish off [QC8318]
[G48.6,37.7Silithus]Turn in [QT8318 Secret Communication]

Grind mobs at the twilight camps until you get 10 Encrypted Twilight Texts\\Turn in [QT8323 True Believers]

--

[G50.59,34.45 Silithus]Fly to [F Un'Goro Crater]--OnStepCompletion>>LoadNextGuide
]], "Zarant")

Guidelime.registerGuide([[
[N59-60Winterspring/Un'Goro/Silithus part 2]
[GA Alliance]
[D Alliance Leveling Guide]
Fly to Un'Goro Crater[OC]
Turn in [QT3962] (7300xp) --It's Dangerous to Go Alone
Fly to [F Tanaris][OC]
Turn in [QT4507] (5450xp) \\Accept [QA4508] --Pawn Captures Queen
[H]Hearth to Everlook
Turn in [QT5163] (7750xp) --Are We There, Yeti? part 3
Finish off/Turn in [QT4809][OC] (5450xp) \\Skip this quest if you have enough xp to ding from all the quest turn-ins from moonglade/darnassus\\(about 35k xp total)
Grind until you are [XP60-34640 34.5k] xp away from 60[OC]
Fly to [F Moonglade]

Turn in [QT6844] (3000xp) \\Accept [QA6845] --Umber, Archivist
Turn in [QT6845] (7550xp) --Uncovering Past Secrets
Turn in [QT5527] (6600xp) --A Reliquary of Purity
Turn in [G44.87,35.62Moonglade][QA1185-][QT1185] (3000xp) --Under the Chitin Was...
[O]Fly to Felwood ang grind fulborgs if you don't have enough XP to ding 60 from quest turn ins in Darnassus--PLAYER_XP_UPDATE,QUEST_LOG_UPDATE,OnStepActivation,OnStepCompletion>>XpTo60,Grind Fulborgs in northern felwood until you have enough XP
[XP60-14490 Assuming you didn't skip any quests you need to grind until you are 14.5k experience away from level 60]
Fly to [F Teldrassil]
Turn in [QT4901] (4800xp)
Accept [QA4902]
Turn in [G41.85,85.64Darnassus][QT4508] (540xp) \\Accept [QA4510] --Calm Before the Storm part 1
Turn in [QT4510] (8150xp) --Calm Before the Storm part 2
Turn in [QT4986] at the middle floor (5800xp) --Glyphed Oaken Branch
Turn in [QT4902] at the top floor (6000xp)
]], "Zarant")


--[[
4507-> 4508-> 4510
5450 + 550  + 8150


1125-> 1126-> 6844-> 6845-> 1185
5650 + 6000 + 3000 + 7550 + 3000
]]


--[[

7300+5450+7750+    3000+7550+6600+3000+    540+8150+5800


209800-79186-5650+6300+8050
]]





if not Guidelime.Zarant then return end

local z = Guidelime.Zarant

local IsOnQuest = C_QuestLog.IsOnQuest
--local IsQuestFlaggedCompleted = C_QuestLog.IsQuestFlaggedCompleted

local function FormatNumber(number,precision)
	if not precision then
		precision = 0
	end
	local integer = math.floor(number)
	local decimal = math.floor((number-integer)*10^precision+0.5)
	if decimal > 0 then
		decimal = '.'..tostring(decimal)
	else
		decimal = ""
	end
	integer = tostring(integer)
	local i = #integer % 3
	if i == 0 then
		i = 3
	end

	local suffix = string.sub(integer,i+1)
	integer = string.sub(integer,1,i)

	for n in string.gmatch(suffix,"%d%d%d") do
		integer = integer..","..n
	end
	return integer..decimal
end

function z:XpTo60(args,event) --PLAYER_XP_UPDATE,QUEST_LOG_UPDATE>>XpTo60
	if UnitLevel("player") ~= 59 or event == "OnStepCompletion" then
		self.questXP = nil
		return 
	end
	
	if event == "QUEST_LOG_UPDATE" or not self.questXP then
		local questXP = 0.0
		if IsOnQuest(6844) then --Moonglade chain
			questXP = questXP + 3000 + 7550 + 3000
		elseif IsQuestFlaggedCompleted(6844) then
			if not IsQuestFlaggedCompleted(6845) then
				questXP = questXP + 7550
			end
			if not IsQuestFlaggedCompleted(1185) then
				questXP = questXP + 3000
			end
		end

		if z.IsQuestComplete(4507) then --pawn captures queen
			questXP = questXP + 5450 + 550  + 8150
		elseif IsQuestFlaggedCompleted(4507) then
			if IsOnQuest(4508) then
				questXP = questXP + 550 + 8150
			elseif not IsQuestFlaggedCompleted(4510) and IsQuestFlaggedCompleted(4508) then
				questXP = questXP + 8150
			end
		end

		if z.IsQuestComplete(3962) then --It's dangerous to go alone
			questXP = questXP + 7300
		end

		if z.IsQuestComplete(5163) then --Are we there yeti?
			questXP = questXP + 7750
		end

		if z.IsQuestComplete(5527) then --A Reliquary of Purity
			questXP = questXP + 6600
		end

		if IsOnQuest(4986) then--Glyphed Oaken Branch
			questXP = questXP + 5800
		end
		
		if z.IsQuestComplete(4901) then --Guardians of the altar
			questXP = questXP + 4800 + 6000
		end
		
		
		self.questXP = questXP
	end
	

	local missingXP = UnitXPMax("player") - UnitXP("player") - self.questXP
	if missingXP <= 0 then
		self:SkipStep()
		return
	end
	
	local text = args[1] or ""
	local element = self.step.elements[#self.step.elements]
	
	local questXP = FormatNumber(self.questXP)
	element.text = string.format("%s\nYou have %s XP worth of quest turn ins outside Silithus\n    XP needed: %s + %s",text,questXP,FormatNumber(missingXP),questXP)


	self:UpdateStep()

end



function z:BankW_Letter59()  --BANKFRAME_OPENED,BAG_UPDATE>>BankW_Winterspring59
	local items = {12899} --Tinkee's Letter
	
	if z.IsItemNotInBank(items) then
		z.SkipStep(self)
		return
	end
	
	z.WithdrawItems(items)
end


function z:BankW_Winterspring59()  --BANKFRAME_OPENED,BAG_UPDATE>>BankW_Winterspring59
	--local items = {"Rabine's Letter","Silvery Claws","Irontree Heart","Remains of Trey Lightforge","Shadow Lord Fel'dan's Head"}
	local items = {17355,11172,11173,13562,13207}
	
	if z.IsItemNotInBank(items) then
		z.SkipStep(self)
		return
	end
	
	z.WithdrawItems(items)
end
